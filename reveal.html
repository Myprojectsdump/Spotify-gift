<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Reveal â€” Your Gift (Uci)</title>
  <link rel="stylesheet" href="assets/css/style.css">
  <script src="assets/js/common.js" defer></script>
<!-- improve Android chrome look & install feel -->
<meta name="theme-color" content="#07102a">
<meta name="mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
<link rel="icon" href="monk.png"> <!-- optional: add a small favicon -->


</head>
<body>
  <div class="container center" style="padding:80px 20px">
    <div class="final-card">
      <h1 style="margin:6px 0 10px">All set, <span class="neon-name">Uci</span> â€” Enjoy the music!</h1>

<!-- reveal banner + premium badge (insert near top of .final-card) -->
<div class="reveal-banner" aria-hidden="false" role="status" aria-live="polite">
  <strong>ğŸ‰ Surprise!</strong>
  <div class="reveal-marquee" aria-hidden="true">
    <span>You've got <strong>Spotify Premium</strong> â€” enjoy ad-free music, downloads & more âœ¨</span>
  </div>
</div>

<!-- sparkles for visual accent -->
<div class="sparkle s1" aria-hidden="true"></div>
<div class="sparkle s2" aria-hidden="true"></div>

<!-- Premium badge -->
<div class="premium-badge" aria-hidden="false">
  <div class="icon">â˜…â˜…â˜…</div>
  <div class="text">
    <div class="title">Spotify Premium â€” Gift Activated !</div>
    <div class="sub">Ad-free, offline listening , music together awarded to Uci â¤ï¸</div>
  </div>
</div>

<!-- hidden live region for screen readers (announces once when revealed) -->
<div id="sr-announce" class="muted" style="position:absolute;left:-9999px;top:auto;overflow:hidden" aria-live="assertive" aria-atomic="true"></div>

      <p style="font-size:20px;margin:10px 0 18px"><strong>Check Telegram for the details</strong></p>
      <p class="muted">I will privately DM the login details on Telegram. Keep the account safe.</p>
      <div style="margin-top:18px;display:flex;gap:12px;justify-content:center;flex-wrap:wrap">
  <a class="btn big" id="done" href="index.html">Done</a>
  <button id="replay" class="btn ghost">Celebrate again</button>
  <button id="musicToggle" class="btn ghost">Pause music â¸</button>
</div>

    </div>
  </div>

  <script>
  document.addEventListener('DOMContentLoaded', function(){
    // ğŸ‰ Confetti behavior
    window.ConfettiSystem.start({count:360, duration:4200});
    const replayBtn = document.getElementById('replay');
    replayBtn.addEventListener('click', ()=> window.ConfettiSystem.start({count:220, duration:3000}));

    const musicToggle = document.getElementById('musicToggle');
    const doneLink = document.getElementById('done');

    // ğŸ§ Restore audio info from sessionStorage
    const savedGenre = sessionStorage.getItem('sg_audio_genre') || 'surprise';
    const savedTime = parseFloat(sessionStorage.getItem('sg_audio_time') || '0');
    const wasPlaying = sessionStorage.getItem('sg_audio_was_playing') === 'true';

    let audio = null;

    // Build src from genre (more robust on GitHub)
    const relSrc = 'assets/audio/vibe_' + savedGenre + '.mp3';

    // If we ever stored a full URL, we can keep it as an optional fallback (not required)
    const savedSrc = sessionStorage.getItem('sg_audio_src');
    const finalSrc = savedSrc || relSrc;

    // Create audio if we have something
    if(savedGenre || savedSrc){
      audio = new Audio(finalSrc);
      audio.loop = true;
      audio.volume = 0.8;

      if(!isNaN(savedTime) && savedTime > 0){
        try { audio.currentTime = savedTime; } catch(e){}
      }

      audio.addEventListener('play', ()=> {
        if(musicToggle) musicToggle.textContent = 'Pause music â¸';
      });
      audio.addEventListener('pause', ()=> {
        if(musicToggle) musicToggle.textContent = 'Play music â–¶';
      });

      if(wasPlaying){
        audio.play().catch(err => {
          console.warn('Autoplay blocked:', err);
          if(musicToggle) musicToggle.textContent = 'Play music â–¶';
        });
      } else {
        if(musicToggle) musicToggle.textContent = 'Play music â–¶';
      }
    } else {
      if(musicToggle) musicToggle.textContent = 'Play music â–¶';
    }

    if(musicToggle){
      musicToggle.addEventListener('click', ()=> {
        if(!audio){
          alert('Music is not loaded from the previous step.');
          return;
        }
        if(audio.paused){
          audio.play().catch(err => console.warn('Play error:', err));
        } else {
          audio.pause();
        }
      });
    }

    if(doneLink){
      doneLink.addEventListener('click', ()=> {
        if(audio) audio.pause();
        sessionStorage.removeItem('sg_audio_src');
        sessionStorage.removeItem('sg_audio_time');
        sessionStorage.removeItem('sg_audio_was_playing');
        sessionStorage.removeItem('sg_audio_genre'); // ğŸ‘ˆ also clear genre
      });
    }
  });
</script>


</body>
</html>

